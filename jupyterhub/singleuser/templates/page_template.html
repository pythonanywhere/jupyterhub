{% extends "templates/page.html" %}

{% block header_buttons %}
{% endblock %}

{% block above_header_container %}
  <iframe 
    src="//jupyterhub_navbar?path={{notebook_path | urlencode}}"
    style="border:0; width:100%; overflow:hidden; scrolling: no; height: 50px; margin-bottom: -25px" 
  ></iframe>
{% endblock %}

{% block logo %}
{% endblock logo %}

{% block script %}
{{ super() }}
<script type='text/javascript'>
  function _remove_redirects_param() {
    // remove ?redirects= param from URL so that
    // successful page loads don't increment the redirect loop counter
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'redirects') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin +
                      window.location.pathname +
                      new_search +
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_redirects_param();
</script>
{% endblock script %}
